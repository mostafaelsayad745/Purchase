# Purchase Process Workflow - Visual Guide
# دليل مرئي لسير عمل عملية الشراء

## Workflow Diagram / مخطط سير العمل

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    8-STEP PURCHASE PROCESS WORKFLOW                     │
│                     سير عمل عملية الشراء من 8 خطوات                    │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│ STEP 1: Initial Request                       الخطوة 1: الطلب الأولي   │
│ ────────────────────────────────────────────────────────────────────────│
│ Work Area submits tool request to Stock Department                     │
│ منطقة العمل تقدم طلب أداة إلى قسم المخزون                              │
│                                                                         │
│ Input: Tool ID, Quantity, Work Area, Reason                           │
│ المدخلات: معرف الأداة، الكمية، منطقة العمل، السبب                      │
└─────────────────────────────────────────────────────────────────────────┘
                                   │
                                   ▼
┌─────────────────────────────────────────────────────────────────────────┐
│ STEP 2: Stock Verification                 الخطوة 2: التحقق من المخزون │
│ ────────────────────────────────────────────────────────────────────────│
│ Check inventory availability                                            │
│ فحص توفر المخزون                                                         │
└─────────────────────────────────────────────────────────────────────────┘
                                   │
                    ┌──────────────┴──────────────┐
                    │                             │
              IN STOCK                      OUT OF STOCK
             متوفر في المخزون               غير متوفر في المخزون
                    │                             │
                    ▼                             ▼
         ┌──────────────────┐      ┌─────────────────────────────────┐
         │ Fulfill Request  │      │ STEP 3: Purchase Request        │
         │ تلبية الطلب      │      │        الخطوة 3: طلب الشراء    │
         │                  │      │ ────────────────────────────────│
         │ Update Stock     │      │ Create formal purchase request  │
         │ تحديث المخزون    │      │ إنشاء طلب شراء رسمي            │
         │                  │      │                                 │
         │ Notify Requester │      │ First Approval Required         │
         │ إخطار مقدم الطلب │      │ الموافقة الأولى مطلوبة          │
         └──────────────────┘      └─────────────────────────────────┘
              │                                   │
              │                        ┌──────────┴──────────┐
              │                        │                     │
              │                   APPROVED              REJECTED
              │                   موافق عليه            مرفوض
              │                        │                     │
              │                        ▼                     ▼
              │        ┌───────────────────────────┐    ┌────────────┐
              │        │ STEP 4: Quotations        │    │ End Process│
              │        │ الخطوة 4: عروض الأسعار    │    │ إنهاء      │
              │        │ ──────────────────────────│    └────────────┘
              │        │ Contact 3+ suppliers      │
              │        │ الاتصال بـ 3+ موردين       │
              │        │                           │
              │        │ Collect quotations        │
              │        │ جمع عروض الأسعار          │
              │        │                           │
              │        │ Auto-rank top 3           │
              │        │ ترتيب أفضل 3 تلقائياً     │
              │        └───────────────────────────┘
              │                     │
              │                     ▼
              │        ┌───────────────────────────┐
              │        │ STEP 5: Best Offer        │
              │        │ الخطوة 5: أفضل عرض        │
              │        │ ──────────────────────────│
              │        │ Review top 3 quotations   │
              │        │ مراجعة أفضل 3 عروض       │
              │        │                           │
              │        │ Second Approval           │
              │        │ الموافقة الثانية          │
              │        │                           │
              │        │ Select best offer         │
              │        │ اختيار أفضل عرض           │
              │        └───────────────────────────┘
              │                     │
              │                     ▼
              │        ┌───────────────────────────┐
              │        │ STEP 6: Purchase Order    │
              │        │ الخطوة 6: أمر الشراء      │
              │        │ ──────────────────────────│
              │        │ Create PO from quotation  │
              │        │ إنشاء أمر شراء من العرض   │
              │        │                           │
              │        │ Upload documents:         │
              │        │ تحميل المستندات:          │
              │        │ • PO                      │
              │        │ • Invoice                 │
              │        │ • Delivery Note           │
              │        │ • Supplier Agreement      │
              │        │                           │
              │        │ Status: Created           │
              │        │ الحالة: تم الإنشاء        │
              │        └───────────────────────────┘
              │                     │
              │                     ▼
              │        ┌───────────────────────────┐
              │        │ STEP 7: Goods Reception   │
              │        │ الخطوة 7: استلام البضائع  │
              │        │ ──────────────────────────│
              │        │ Physical receipt by stock │
              │        │ الاستلام الفعلي بالمخزون   │
              │        │                           │
              │        │ Verify:                   │
              │        │ التحقق من:                │
              │        │ • Quantity (±5% tolerance)│
              │        │   الكمية (تحمل ±5%)       │
              │        │ • Quality                 │
              │        │   الجودة                  │
              │        │ • Condition               │
              │        │   الحالة                  │
              │        │                           │
              │        │ Update stock quantity     │
              │        │ تحديث كمية المخزون        │
              │        │                           │
              │        │ Status: Received & Inspected│
              │        │ الحالة: مستلم ومفحوص      │
              │        └───────────────────────────┘
              │                     │
              │                     ▼
              │        ┌───────────────────────────┐
              │        │ STEP 8: Payment           │
              │        │ الخطوة 8: الدفع           │
              │        │ ──────────────────────────│
              │        │ Financial review          │
              │        │ المراجعة المالية          │
              │        │                           │
              │        │ Verify checklist:         │
              │        │ قائمة التحقق:             │
              │        │ ✓ Document completeness   │
              │        │   اكتمال المستندات        │
              │        │ ✓ Quantity matching       │
              │        │   مطابقة الكمية           │
              │        │ ✓ Price accuracy          │
              │        │   دقة السعر               │
              │        │                           │
              │        │ Process payment           │
              │        │ معالجة الدفع              │
              │        │                           │
              │        │ Status: Paid              │
              │        │ الحالة: مدفوع             │
              │        │                           │
              │        │ Archive complete cycle    │
              │        │ أرشفة الدورة الكاملة      │
              │        └───────────────────────────┘
              │                     │
              └─────────────────────┴───────► END / النهاية


═══════════════════════════════════════════════════════════════════════════

## Status Flow / تدفق الحالة

ToolRequest Status:
  • Pending          → قيد الانتظار
  • InStock          → متوفر في المخزون
  • OutOfStock       → غير متوفر
  • Rejected         → مرفوض

PurchaseRequest Status:
  • PendingApproval  → في انتظار الموافقة
  • Approved         → موافق عليه
  • Rejected         → مرفوض

Quotation Status:
  • Submitted        → مقدم
  • Ranked (1-3)     → مرتب (1-3)
  • Selected         → محدد
  • Rejected         → مرفوض

PurchaseOrder Status:
  • Created          → تم الإنشاء
  • Received         → تم الاستلام
  • Inspected        → تم الفحص
  • Paid             → تم الدفع

GoodsReceipt Quality Status:
  • Accepted         → مقبول
  • Rejected         → مرفوض
  • PartiallyAccepted → مقبول جزئياً

Payment Status:
  • Pending          → قيد الانتظار
  • Completed        → مكتمل
  • Failed           → فشل

═══════════════════════════════════════════════════════════════════════════

## User Roles & Responsibilities / أدوار المستخدمين والمسؤوليات

┌──────────────────┬──────────────────────────────────────────────────────┐
│ Role             │ Responsibilities                                     │
│ الدور            │ المسؤوليات                                           │
├──────────────────┼──────────────────────────────────────────────────────┤
│ Requester        │ • Submit tool requests                               │
│ مقدم الطلب       │ • تقديم طلبات الأدوات                                │
│                  │ • Track request status                               │
│                  │ • متابعة حالة الطلب                                  │
├──────────────────┼──────────────────────────────────────────────────────┤
│ StockManager     │ • Verify stock availability                          │
│ مدير المخزون     │ • التحقق من توفر المخزون                             │
│                  │ • Receive goods                                      │
│                  │ • استلام البضائع                                     │
│                  │ • Update inventory                                   │
│                  │ • تحديث المخزون                                      │
├──────────────────┼──────────────────────────────────────────────────────┤
│ FirstApprover    │ • Review purchase requests                           │
│ الموافق الأول    │ • مراجعة طلبات الشراء                               │
│                  │ • Approve/reject requests                            │
│                  │ • الموافقة/رفض الطلبات                               │
├──────────────────┼──────────────────────────────────────────────────────┤
│ SecondApprover   │ • Review top 3 quotations                            │
│ الموافق الثاني   │ • مراجعة أفضل 3 عروض أسعار                          │
│                  │ • Select best offer                                  │
│                  │ • اختيار أفضل عرض                                    │
├──────────────────┼──────────────────────────────────────────────────────┤
│ FinancialOfficer │ • Review payment documentation                       │
│ الموظف المالي    │ • مراجعة مستندات الدفع                              │
│                  │ • Process payments                                   │
│                  │ • معالجة المدفوعات                                   │
│                  │ • Archive completed cycles                           │
│                  │ • أرشفة الدورات المكتملة                             │
└──────────────────┴──────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════

## Error Handling & Escalation / معالجة الأخطاء والتصعيد

1. Request Rejection / رفض الطلب
   → Notify requester / إخطار مقدم الطلب
   → Log rejection reason / تسجيل سبب الرفض
   → End workflow / إنهاء سير العمل

2. Insufficient Quotations / عروض أسعار غير كافية
   → Alert to contact more suppliers / تنبيه للاتصال بموردين إضافيين
   → Cannot proceed until 3 minimum / لا يمكن المتابعة حتى 3 كحد أدنى

3. Quantity Variance > ±5% / تباين الكمية > ±5%
   → Escalate to management / التصعيد للإدارة
   → Document variance / توثيق التباين
   → Decide: Accept/Reject / القرار: قبول/رفض

4. Quality Issues / مشاكل الجودة
   → Reject goods / رفض البضائع
   → Contact supplier / الاتصال بالمورد
   → Request replacement / طلب البديل

5. Payment Processing Failure / فشل معالجة الدفع
   → Alert financial officer / تنبيه الموظف المالي
   → Investigate issue / التحقيق في المشكلة
   → Retry or escalate / إعادة المحاولة أو التصعيد

═══════════════════════════════════════════════════════════════════════════

## Integration Points / نقاط التكامل

┌─────────────────────────────────────────────────────────────────────────┐
│ Frontend (Angular) ↔ Backend (ASP.NET Core Web API)                    │
│ الواجهة الأمامية (Angular) ↔ الخلفية (ASP.NET Core Web API)            │
├─────────────────────────────────────────────────────────────────────────┤
│ • RESTful API communication / اتصال RESTful API                        │
│ • JWT Authentication (future) / مصادقة JWT (مستقبلاً)                  │
│ • Real-time updates (SignalR - future) / تحديثات فورية (مستقبلاً)      │
│ • File upload/download / رفع/تنزيل الملفات                             │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│ Backend (ASP.NET Core) ↔ Database (SQL Server)                         │
│ الخلفية (ASP.NET Core) ↔ قاعدة البيانات (SQL Server)                   │
├─────────────────────────────────────────────────────────────────────────┤
│ • Entity Framework Core ORM                                             │
│ • Code-First migrations / الترحيلات من الكود أولاً                     │
│ • Automatic schema generation / إنشاء المخطط تلقائياً                  │
└─────────────────────────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════
